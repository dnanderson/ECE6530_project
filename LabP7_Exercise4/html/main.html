
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>main</title><meta name="generator" content="MATLAB 9.13"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-04-28"><meta name="DC.source" content="main.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">4.1 Generating the Bell Envelopes</a></li><li><a href="#2">4.2 Parameters for the Bell</a></li><li><a href="#3">4.3 The Bell Sound</a></li><li><a href="#4">Case 1 - fc=110 Hz; fm=220 Hz; I0=10; tau=2sec; dur=6sec; fs=11025;</a></li><li><a href="#5">a) Listen to sound by playing it with the soundsc function</a></li><li><a href="#6">b) Calculate the fundamental frequency of the "note" being played.</a></li><li><a href="#7">c) Describe how you can hear the frequency content changing according to I(t)</a></li><li><a href="#8">d) Display a spectrogram of the signal</a></li><li><a href="#9">e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv</a></li><li><a href="#10">f) Plot about 100&#8211;200 samples from the middle of the signal and explain what you see, especially the frequency variation.</a></li><li><a href="#11">Case 2 - fc=220 Hz; fm=440 Hz; I0=5; tau=2sec; dur=6sec; fs=11025;</a></li><li><a href="#12">a) Listen to sound by playing it with the soundsc function</a></li><li><a href="#13">b) Calculate the fundamental frequency of the "note" being played.</a></li><li><a href="#14">c) Describe how you can hear the frequency content changing according to I(t)</a></li><li><a href="#15">d) Display a spectrogram of the signal</a></li><li><a href="#16">e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv</a></li><li><a href="#17">f) Plot about 100&#8211;200 samples from the middle of the signal and explain what you see, especially the frequency variation.</a></li><li><a href="#18">Case 3 - fc=110 Hz; fm=220 Hz; I0=10; tau=12sec; dur=3sec; fs=11025;</a></li><li><a href="#19">a) Listen to sound by playing it with the soundsc function</a></li><li><a href="#20">b) Calculate the fundamental frequency of the "note" being played.</a></li><li><a href="#21">c) Describe how you can hear the frequency content changing according to I(t)</a></li><li><a href="#22">d) Display a spectrogram of the signal</a></li><li><a href="#23">e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv</a></li><li><a href="#24">f) Plot about 100&#8211;200 samples from the middle of the signal and explain what you see, especially the frequency variation.</a></li><li><a href="#25">Case 4 - fc=110 Hz; fm=220 Hz; I0=10; tau=.3sec; dur=3sec; fs=11025;</a></li><li><a href="#26">a) Listen to sound by playing it with the soundsc function</a></li><li><a href="#27">b) Calculate the fundamental frequency of the "note" being played.</a></li><li><a href="#28">c) Describe how you can hear the frequency content changing according to I(t)</a></li><li><a href="#29">d) Display a spectrogram of the signal</a></li><li><a href="#30">e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv</a></li><li><a href="#31">f) Plot about 100&#8211;200 samples from the middle of the signal and explain what you see, especially the frequency variation.</a></li><li><a href="#32">Case 5 - fc=250 Hz; fm=350 Hz; I0=5; tau=2sec; dur=5sec; fs=11025;</a></li><li><a href="#33">a) Listen to sound by playing it with the soundsc function</a></li><li><a href="#34">b) Calculate the fundamental frequency of the "note" being played.</a></li><li><a href="#35">c) Describe how you can hear the frequency content changing according to I(t)</a></li><li><a href="#36">d) Display a spectrogram of the signal</a></li><li><a href="#37">e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv</a></li><li><a href="#38">f) Plot about 100&#8211;200 samples from the middle of the signal and explain what you see, especially the frequency variation.</a></li><li><a href="#39">Case 6 - fc=250 Hz; fm=350 Hz; I0=3; tau=1sec; dur=5sec; fs=11025;</a></li><li><a href="#40">a) Listen to sound by playing it with the soundsc function</a></li><li><a href="#41">b) Calculate the fundamental frequency of the "note" being played.</a></li><li><a href="#42">c) Describe how you can hear the frequency content changing according to I(t)</a></li><li><a href="#43">d) Display a spectrogram of the signal</a></li><li><a href="#44">e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv</a></li><li><a href="#45">f) Plot about 100&#8211;200 samples from the middle of the signal and explain what you see, especially the frequency variation.</a></li><li><a href="#46">4.4 Modifying the Fundamental Frequency</a></li><li><a href="#47">Test 1: Fc = 50 and Fm = 100 =&gt; F0 ~ 50</a></li><li><a href="#48">Test 2: fc = 200 fm = 400 =&gt; F0 ~ 200</a></li><li><a href="#49">Test 3: fc = 400 fm = 800 =&gt; F0 ~ 400</a></li><li><a href="#50">Test 4: fc = 800 fm = 1600 =&gt; F0 ~ 800</a></li><li><a href="#51">Frequency Modulation Ratio Tests</a></li><li><a href="#52">Test 1: 5:7 Ratio (f0 = 40)</a></li><li><a href="#53">Test 2: 7:5 Ratio (f0 = 40)</a></li><li><a href="#54">Test 3: 1:6</a></li><li><a href="#55">Test 4: 7:11 Ratio</a></li><li><a href="#56">Which parameters sound best?</a></li></ul></div><h2 id="1">4.1 Generating the Bell Envelopes</h2><pre class="codeinput"><span class="comment">%See bellenv.m for details on function construction</span>
</pre><h2 id="2">4.2 Parameters for the Bell</h2><pre class="codeinput"><span class="comment">%See bell.m for details on how the bell sound function is constructed</span>
</pre><h2 id="3">4.3 The Bell Sound</h2><h2 id="4">Case 1 - fc=110 Hz; fm=220 Hz; I0=10; tau=2sec; dur=6sec; fs=11025;</h2><h2 id="5">a) Listen to sound by playing it with the soundsc function</h2><pre class="codeinput"><span class="comment">%run bell function and create array of values</span>

<span class="comment">% ff = frequency vector (containing fc and fm)</span>
ff1 = [110,220];
<span class="comment">% Io = scale factor for modulation index</span>
Io1 = 10;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau1 = 2;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur1 = 6;
<span class="comment">% fsamp = sampling rate</span>
fsamp1 = 11025;


y1 = bell(ff1,Io1,tau1,dur1,fsamp1);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y1, fsamp1);
</pre><h2 id="6">b) Calculate the fundamental frequency of the "note" being played.</h2><pre class="codeinput"><span class="comment">% The fundamental frequency is calculated by finding the fourier transform</span>
<span class="comment">% or FFT of the bell sound and finding the frequency value with the first</span>
<span class="comment">% promiment peak. Any peaks that occur above this frequency are simply</span>
<span class="comment">% harmonics.</span>
<span class="comment">% (https://www.mathworks.com/help/matlab/math/fourier-transforms.html)</span>
m1 = length(y1);
n1 = pow2(nextpow2(m1));
y1fft = fft(y1, n1);
f1 = (0:n1)*fsamp1/n1;
power1 = abs(y1fft).^2/n1;

<span class="comment">%figure();</span>
<span class="comment">%plot(f1(1:floor(n1/2)),power1(1:floor(n1/2)));</span>

peaks1 = islocalmax(power1, <span class="string">'MinProminence'</span>, 1);
f01 = 0;
<span class="keyword">for</span> i = 1:length(peaks1)
    <span class="keyword">if</span>(peaks1(i) == 1)
        f01 = i*fsamp1/n1;
        <span class="keyword">break</span>;
    <span class="keyword">else</span>
        <span class="keyword">continue</span>;
    <span class="keyword">end</span>
<span class="keyword">end</span>


<span class="comment">%%Explain how you can verify by listening that you have the correct fundamental frequency.</span>
<span class="comment">% Just by listening, we can verify that we have the correct fundamental</span>
<span class="comment">% frequency by varying the carrier and modulating function parameters to get higher</span>
<span class="comment">% and lower toned sounds and see if our fundamental frequency calcuation is</span>
<span class="comment">% also going up and down with the tone changes. We can also compare the sound of our created</span>
<span class="comment">% note with the sound of the calculated natural freqeuncy using an online tone generator.</span>
</pre><h2 id="7">c) Describe how you can hear the frequency content changing according to I(t)</h2><p>The frequency content is most modified by changing the Io value. Changing tau affects how quickly the sound decays within the duration and the duration obviously affects how long the sound plays in general. The interesting change is with Io where the lower the modulation index is the 'purer' the tone sounds. There are fewer reverberations and overtones/harmonics. The more we raise the Io value the more overtones and harmonics we hear.</p><pre class="codeinput"><span class="comment">%%Plot fi(t) versus t for comparison</span>
<span class="comment">% fi(t) = fc - I(t)*fm*sin(2pi*fm*t+phi_m) + dI/dt*cos(2*pi*fm*t+phi_m)</span>
<span class="comment">% (dI/dt = -1/tau * I0 * exp(-t/tau)</span>

<span class="comment">%defining terms</span>
Psi_m1 = -pi/2;
Psi_c1 = -pi/2;
t1 =  0:1/fsamp1:dur1;

I_t1 = Io1 * bellenv(tau1, dur1, fsamp1); <span class="comment">%call bell envelope function (exponential decay)</span>

<span class="comment">%calcualting fi_t</span>
fi_t1 = ff1(1,1) - I_t1.*ff1(1,2).*cos(2*pi*ff1(1,1)*t1+Io1*I_t1*-1/tau1.*cos(2*pi*ff1(1,2)*t1+Psi_m1)+Psi_c1);

<span class="comment">%All 6 cases will have their fi(t) plots plotted together on the same plot</span>
<span class="comment">%for comparison sake</span>

<span class="comment">%plotting normalized I(t) and fi(t)</span>
figure(2);
subplot(3,2,1)
plot(t1, fi_t1/max(fi_t1), <span class="string">'-b'</span>);
hold <span class="string">on</span>;
plot(t1, I_t1/max(I_t1), <span class="string">'-r'</span>);
hold <span class="string">off</span>;
title(<span class="string">'Case 1 fi(t) vs. t'</span>);

figure();
plot(t1, fi_t1/max(fi_t1), <span class="string">'-b'</span>);
hold <span class="string">on</span>;
plot(t1, I_t1/max(I_t1), <span class="string">'-r'</span>);
hold <span class="string">off</span>;
title(<span class="string">'Case 1 fi(t) vs. t'</span>);
</pre><img vspace="5" hspace="5" src="main_01.png" alt=""> <img vspace="5" hspace="5" src="main_02.png" alt=""> <h2 id="8">d) Display a spectrogram of the signal</h2><pre class="codeinput">figure();
plotspec(y1, fsamp1, 256);
title(<span class="string">'Case 1 Spectrogram'</span>);

<span class="comment">%%Describe how the frequency content changes, and how that change is related to I(t)</span>
<span class="comment">% The frequency content changes with I(t) by showing how long the harmonics</span>
<span class="comment">% and overtones last. We can see that the faster the decay rate or the</span>
<span class="comment">% larger tau is the sooner the frequency spectrum begins to have a</span>
<span class="comment">% diminshed influence from higher frequency aspects of the signal. Io also</span>
<span class="comment">% affects the plot by adding in higher frequency spectral lines. The</span>
<span class="comment">% higher the Io value the more harmonics or spectral lines we see on the graph.</span>

<span class="comment">%%Point out the "harmonic" structure of the spectrogram, and calculate the fundamental frequency, f0</span>
<span class="comment">% The fundamental frequency has been calculated at this point and the</span>
<span class="comment">% spectrogram shows that the fundamental frequency value is the one that</span>
<span class="comment">% has the strongest presence in the spectrogram at the end of the duration</span>
<span class="comment">% of the signal. The harmonic structure is seen with the spectral lines that</span>
<span class="comment">% show how at the beginning of the noise a large number of frequencies</span>
<span class="comment">% contribute to the sound but by the end of the sound we are left with the</span>
<span class="comment">% fundamental frequency and maybe the first or second harmonic.</span>

<span class="comment">%Case 1 fundamental frequency calculation result</span>
f01
</pre><pre class="codeoutput">
f01 =

  109.6848

</pre><img vspace="5" hspace="5" src="main_03.png" alt=""> <h2 id="9">e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv</h2><pre class="codeinput"><span class="comment">%recalculating A(t)</span>
A_t1 = bellenv(tau1, dur1, fsamp1);

<span class="comment">%plot the signal</span>
figure();
plot(y1);
set(gca,<span class="string">'FontSize'</span>,14); <span class="comment">%set font size</span>
title(<span class="string">'Case 1 Signal and A(t)'</span>,<span class="string">'FontSize'</span>,14); <span class="comment">%Title</span>
subtitle(<span class="string">'Signal = blue line A(t) = red line'</span>);
xlabel(<span class="string">'Time'</span>, <span class="string">'FontSize'</span>,14);<span class="comment">% X-axis Label</span>
ylabel(<span class="string">'Amplitude'</span>, <span class="string">'FontSize'</span>,14);<span class="comment">% Y-axis Label</span>
drawnow; <span class="comment">%ensure drawings are complete</span>
hold <span class="string">on</span>;
plot(A_t1, <span class="string">'-r'</span>, <span class="string">'LineWidth'</span>, 2);
hold <span class="string">off</span>;
</pre><img vspace="5" hspace="5" src="main_04.png" alt=""> <h2 id="10">f) Plot about 100&#8211;200 samples from the middle of the signal and explain what you see, especially the frequency variation.</h2><pre class="codeinput">figure();
plot(y1(100:1:300));
title(<span class="string">'Case 1 200 samples'</span>);

<span class="comment">% This view of 200 samples shows a pattern with one spaced out peak followed</span>
<span class="comment">% by three closely spaced peaks. This pattern shows that there are areas</span>
<span class="comment">% where a lower frequency is predominant and other areas where higher</span>
<span class="comment">% frequency aspects of the signal are showing up.</span>
</pre><img vspace="5" hspace="5" src="main_05.png" alt=""> <h2 id="11">Case 2 - fc=220 Hz; fm=440 Hz; I0=5; tau=2sec; dur=6sec; fs=11025;</h2><h2 id="12">a) Listen to sound by playing it with the soundsc function</h2><pre class="codeinput"><span class="comment">%run bell function and create array of values</span>

<span class="comment">% ff = frequency vector (containing fc and fm)</span>
ff2 = [220,440];
<span class="comment">% Io = scale factor for modulation index</span>
Io2 = 5;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau2 = 2;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur2 = 6;
<span class="comment">% fsamp = sampling rate</span>
fsamp2 = 11025;


y2 = bell(ff2,Io2,tau2,dur2,fsamp2);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y2, fsamp2);
</pre><h2 id="13">b) Calculate the fundamental frequency of the "note" being played.</h2><pre class="codeinput"><span class="comment">% The fundamental frequency is calculated by finding the fourier transform</span>
<span class="comment">% or FFT of the bell sound and finding the frequency value with the first</span>
<span class="comment">% promiment peak. Any peaks that occur above this frequency are simply</span>
<span class="comment">% harmonics.</span>
<span class="comment">% (https://www.mathworks.com/help/matlab/math/fourier-transforms.html)</span>
m2 = length(y2);
n2 = pow2(nextpow2(m2));
y2fft = fft(y2, n2);
f2 = (0:n2)*fsamp2/n2;
power2 = abs(y2fft).^2/n2;

<span class="comment">%figure();</span>
<span class="comment">%plot(f2(1:floor(n2/2)),power2(1:floor(n2/2)));</span>

peaks2 = islocalmax(power2, <span class="string">'MinProminence'</span>, 1);
f02 = 0;
<span class="keyword">for</span> i = 1:length(peaks2)
    <span class="keyword">if</span>(peaks2(i) == 1)
        f02 = i*fsamp2/n2;
        <span class="keyword">break</span>;
    <span class="keyword">else</span>
        <span class="keyword">continue</span>;
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment">%%Explain how you can verify by listening that you have the correct fundamental frequency.</span>
<span class="comment">% Just by listening, we can verify that we have the correct fundamental</span>
<span class="comment">% frequency by varying the carrier and modulating function parameters to get higher</span>
<span class="comment">% and lower toned sounds and see if our fundamental frequency calcuation is</span>
<span class="comment">% also going up and down with the tone changes. We can also compare the sound of our created</span>
<span class="comment">% note with the sound of the calculated natural freqeuncy using an online tone generator.</span>
</pre><h2 id="14">c) Describe how you can hear the frequency content changing according to I(t)</h2><p>The frequency content is most modified by changing the Io value. Changing tau affects how quickly the sound decays within the duration and the duration obviously affects how long the sound plays in general. The interesting change is with Io where the lower the modulation index is the 'purer' the tone sounds. There are fewer reverberations and overtones/harmonics. The more we raise the Io value the more overtones and harmonics we hear.</p><pre class="codeinput"><span class="comment">%%Plot fi(t) versus t for comparison</span>
<span class="comment">% fi(t) = fc - I(t)*fm*sin(2pi*fm*t+phi_m) + dI/dt*cos(2*pi*fm*t+phi_m)</span>
<span class="comment">% (dI/dt = -1/tau * I0 * exp(-t/tau)</span>

<span class="comment">%defining terms</span>
Psi_m2 = -pi/2;
Psi_c2 = -pi/2;
t2 =  0:1/fsamp1:dur1;

I_t2 = Io2 * bellenv(tau2, dur2, fsamp2); <span class="comment">%call bell envelope function (exponential decay)</span>

<span class="comment">%calcualting fi_t</span>
fi_t2 = ff2(1,1) - I_t2.*ff2(1,2).*cos(2*pi*ff2(1,1)*t2+Io2*I_t2*-1/tau2.*cos(2*pi*ff2(1,2)*t2+Psi_m2)+Psi_c2);

<span class="comment">%All 6 cases will have their fi(t) plots plotted together on the same plot</span>
<span class="comment">%for comparison sake</span>

<span class="comment">%plotting normalized I(t) and fi(t)</span>
figure(2);
subplot(3,2,2)
plot(t2, fi_t2/max(fi_t2), <span class="string">'-b'</span>);
hold <span class="string">on</span>;
plot(t2, I_t2/max(I_t2), <span class="string">'-r'</span>);
hold <span class="string">off</span>;
title(<span class="string">'Case 2 fi(t) vs. t'</span>);
</pre><img vspace="5" hspace="5" src="main_06.png" alt=""> <h2 id="15">d) Display a spectrogram of the signal</h2><pre class="codeinput">figure();
plotspec(y2, fsamp2, 256);
title(<span class="string">'Case 2 Spectrogram'</span>);

<span class="comment">%%Describe how the frequency content changes, and how that change is related to I(t)</span>
<span class="comment">% The frequency content changes with I(t) by showing how long the harmonics</span>
<span class="comment">% and overtones last. We can see that the faster the decay rate or the</span>
<span class="comment">% larger tau is the sooner the frequency spectrum begins to have a</span>
<span class="comment">% diminshed influence from higher frequency aspects of the signal. Io also</span>
<span class="comment">% affects the plot by adding in higher frequency spectral lines. The</span>
<span class="comment">% higher the Io value the more harmonics or spectral lines we see on the graph.</span>

<span class="comment">%%Point out the "harmonic" structure of the spectrogram, and calculate the fundamental frequency, f0</span>
<span class="comment">% The fundamental frequency has been calculated at this point and the</span>
<span class="comment">% spectrogram shows that the fundamental frequency value is the one that</span>
<span class="comment">% has the strongest presence in the spectrogram at the end of the duration</span>
<span class="comment">% of the signal. The harmonic structure is seen with the spectral lines that</span>
<span class="comment">% show how at the beginning of the noise a large number of frequencies</span>
<span class="comment">% contribute to the sound but by the end of the sound we are left with the</span>
<span class="comment">% fundamental frequency and maybe the first or second harmonic.</span>

<span class="comment">%Case 2 fundamental frequency calculation result</span>
f02
</pre><pre class="codeoutput">
f02 =

  219.9583

</pre><img vspace="5" hspace="5" src="main_07.png" alt=""> <h2 id="16">e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv</h2><pre class="codeinput"><span class="comment">%recalculating A(t)</span>
A_t2 = bellenv(tau2, dur2, fsamp2);

<span class="comment">%plot the signal</span>
figure();
plot(y2);
set(gca,<span class="string">'FontSize'</span>,14); <span class="comment">%set font size</span>
title(<span class="string">'Case 2 Signal and A(t)'</span>,<span class="string">'FontSize'</span>,14); <span class="comment">%Title</span>
subtitle(<span class="string">'Signal = blue line A(t) = red line'</span>);
xlabel(<span class="string">'Time'</span>, <span class="string">'FontSize'</span>,14);<span class="comment">% X-axis Label</span>
ylabel(<span class="string">'Amplitude'</span>, <span class="string">'FontSize'</span>,14);<span class="comment">% Y-axis Label</span>
drawnow; <span class="comment">%ensure drawings are complete</span>
hold <span class="string">on</span>;
plot(A_t2, <span class="string">'-r'</span>, <span class="string">'LineWidth'</span>, 2);
hold <span class="string">off</span>;
</pre><img vspace="5" hspace="5" src="main_08.png" alt=""> <h2 id="17">f) Plot about 100&#8211;200 samples from the middle of the signal and explain what you see, especially the frequency variation.</h2><pre class="codeinput">figure();
plot(y2(100:1:300));
title(<span class="string">'Case 2 200 samples'</span>);

<span class="comment">% This view of 200 samples shows a pattern with one spaced out peak followed</span>
<span class="comment">% by three closely spaced peaks. This pattern shows that there are areas</span>
<span class="comment">% where a lower frequency is predominant and other areas where higher</span>
<span class="comment">% frequency aspects of the signal are showing up.</span>
</pre><img vspace="5" hspace="5" src="main_09.png" alt=""> <h2 id="18">Case 3 - fc=110 Hz; fm=220 Hz; I0=10; tau=12sec; dur=3sec; fs=11025;</h2><h2 id="19">a) Listen to sound by playing it with the soundsc function</h2><pre class="codeinput"><span class="comment">%run bell function and create array of values</span>

<span class="comment">% ff = frequency vector (containing fc and fm)</span>
ff3 = [110,220];
<span class="comment">% Io = scale factor for modulation index</span>
Io3 = 10;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau3 = 12;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur3 = 3;
<span class="comment">% fsamp = sampling rate</span>
fsamp3 = 11025;

y3 = bell(ff3,Io3,tau3,dur3,fsamp3);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y3, fsamp3);
</pre><h2 id="20">b) Calculate the fundamental frequency of the "note" being played.</h2><pre class="codeinput"><span class="comment">% The fundamental frequency is calculated by finding the fourier transform</span>
<span class="comment">% or FFT of the bell sound and finding the frequency value with the first</span>
<span class="comment">% promiment peak. Any peaks that occur above this frequency are simply</span>
<span class="comment">% harmonics.</span>
<span class="comment">% (https://www.mathworks.com/help/matlab/math/fourier-transforms.html)</span>
m3 = length(y3);
n3 = pow2(nextpow2(m3));
y3fft = fft(y3, n3);
f3 = (0:n3)*fsamp3/n3;
power3 = abs(y3fft).^2/n3;

<span class="comment">%figure();</span>
<span class="comment">%plot(f3(1:floor(n3/2)),power3(1:floor(n3/2)));</span>

peaks3 = islocalmax(power3, <span class="string">'MinProminence'</span>, 1);
f03 = 0;
<span class="keyword">for</span> i = 1:length(peaks3)
    <span class="keyword">if</span>(peaks3(i) == 1)
        f03 = i*fsamp3/n3;
        <span class="keyword">break</span>;
    <span class="keyword">else</span>
        <span class="keyword">continue</span>;
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment">%%Explain how you can verify by listening that you have the correct fundamental frequency.</span>
<span class="comment">% Just by listening, we can verify that we have the correct fundamental</span>
<span class="comment">% frequency by varying the carrier and modulating function parameters to get higher</span>
<span class="comment">% and lower toned sounds and see if our fundamental frequency calcuation is</span>
<span class="comment">% also going up and down with the tone changes. We can also compare the sound of our created</span>
<span class="comment">% note with the sound of the calculated natural freqeuncy using an online tone generator.</span>
</pre><h2 id="21">c) Describe how you can hear the frequency content changing according to I(t)</h2><p>The frequency content is most modified by changing the Io value. Changing tau affects how quickly the sound decays within the duration and the duration obviously affects how long the sound plays in general. The interesting change is with Io where the lower the modulation index is the 'purer' the tone sounds. There are fewer reverberations and overtones/harmonics. The more we raise the Io value the more overtones and harmonics we hear.</p><pre class="codeinput"><span class="comment">%%Plot fi(t) versus t for comparison</span>
<span class="comment">% fi(t) = fc - I(t)*fm*sin(2pi*fm*t+phi_m) + dI/dt*cos(2*pi*fm*t+phi_m)</span>
<span class="comment">% (dI/dt = -1/tau * I0 * exp(-t/tau)</span>

<span class="comment">%defining terms</span>
Psi_m3 = -pi/2;
Psi_c3 = -pi/2;
t3 =  0:1/fsamp3:dur3;

I_t3 = Io3 * bellenv(tau3, dur3, fsamp3); <span class="comment">%call bell envelope function (exponential decay)</span>

<span class="comment">%calcualting fi_t</span>
fi_t3 = ff3(1,1) - I_t3.*ff3(1,2).*cos(2*pi*ff3(1,1)*t3+Io3*I_t3*-1/tau3.*cos(2*pi*ff3(1,2)*t3+Psi_m3)+Psi_c3);

<span class="comment">%All 6 cases will have their fi(t) plots plotted together on the same plot</span>
<span class="comment">%for comparison sake</span>

<span class="comment">%plotting normalized I(t) and fi(t)</span>
figure(2);
subplot(3,2,3)
plot(t3, fi_t3/max(fi_t3), <span class="string">'-b'</span>);
hold <span class="string">on</span>;
plot(t3, I_t3/max(I_t3), <span class="string">'-r'</span>);
hold <span class="string">off</span>;
title(<span class="string">'Case 3 fi(t) vs. t'</span>);
</pre><img vspace="5" hspace="5" src="main_10.png" alt=""> <h2 id="22">d) Display a spectrogram of the signal</h2><pre class="codeinput">figure();
plotspec(y3, fsamp3, 256);
title(<span class="string">'Case 3 Spectrogram'</span>);

<span class="comment">%%Describe how the frequency content changes, and how that change is related to I(t)</span>
<span class="comment">% The frequency content changes with I(t) by showing how long the harmonics</span>
<span class="comment">% and overtones last. We can see that the faster the decay rate or the</span>
<span class="comment">% larger tau is the sooner the frequency spectrum begins to have a</span>
<span class="comment">% diminshed influence from higher frequency aspects of the signal. Io also</span>
<span class="comment">% affects the plot by adding in higher frequency spectral lines. The</span>
<span class="comment">% higher the Io value the more harmonics or spectral lines we see on the graph.</span>

<span class="comment">%%Point out the "harmonic" structure of the spectrogram, and calculate the fundamental frequency, f0</span>
<span class="comment">% The fundamental frequency has been calculated at this point and the</span>
<span class="comment">% spectrogram shows that the fundamental frequency value is the one that</span>
<span class="comment">% has the strongest presence in the spectrogram at the end of the duration</span>
<span class="comment">% of the signal. The harmonic structure is seen with the spectral lines that</span>
<span class="comment">% show how at the beginning of the noise a large number of frequencies</span>
<span class="comment">% contribute to the sound but by the end of the sound we are left with the</span>
<span class="comment">% fundamental frequency and maybe the first or second harmonic.</span>

<span class="comment">%Case 3 fundamental frequency calculation result</span>
f03
</pre><pre class="codeoutput">
f03 =

  108.5072

</pre><img vspace="5" hspace="5" src="main_11.png" alt=""> <h2 id="23">e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv</h2><pre class="codeinput"><span class="comment">%recalculating A(t)</span>
A_t3 = bellenv(tau3, dur3, fsamp3);

<span class="comment">%plot the signal</span>
figure();
plot(y3);
set(gca,<span class="string">'FontSize'</span>,14); <span class="comment">%set font size</span>
title(<span class="string">'Case 3 Signal and A(t)'</span>,<span class="string">'FontSize'</span>,14); <span class="comment">%Title</span>
subtitle(<span class="string">'Signal = blue line A(t) = red line'</span>);
xlabel(<span class="string">'Time'</span>, <span class="string">'FontSize'</span>,14);<span class="comment">% X-axis Label</span>
ylabel(<span class="string">'Amplitude'</span>, <span class="string">'FontSize'</span>,14);<span class="comment">% Y-axis Label</span>
drawnow; <span class="comment">%ensure drawings are complete</span>
hold <span class="string">on</span>;
plot(A_t3, <span class="string">'-r'</span>, <span class="string">'LineWidth'</span>, 2);
hold <span class="string">off</span>;
</pre><img vspace="5" hspace="5" src="main_12.png" alt=""> <h2 id="24">f) Plot about 100&#8211;200 samples from the middle of the signal and explain what you see, especially the frequency variation.</h2><pre class="codeinput">figure();
plot(y3(100:1:300));
title(<span class="string">'Case 3 200 samples'</span>);

<span class="comment">% This view of 200 samples shows a pattern with one spaced out peak followed</span>
<span class="comment">% by three closely spaced peaks. This pattern shows that there are areas</span>
<span class="comment">% where a lower frequency is predominant and other areas where higher</span>
<span class="comment">% frequency aspects of the signal are showing up.</span>
</pre><img vspace="5" hspace="5" src="main_13.png" alt=""> <h2 id="25">Case 4 - fc=110 Hz; fm=220 Hz; I0=10; tau=.3sec; dur=3sec; fs=11025;</h2><h2 id="26">a) Listen to sound by playing it with the soundsc function</h2><pre class="codeinput"><span class="comment">%run bell function and create array of values</span>

<span class="comment">% ff = frequency vector (containing fc and fm)</span>
ff4 = [110,220];
<span class="comment">% Io = scale factor for modulation index</span>
Io4 = 10;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau4 = .3;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur4 = 3;
<span class="comment">% fsamp = sampling rate</span>
fsamp4 = 11025;


y4 = bell(ff4,Io4,tau4,dur4,fsamp4);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y4, fsamp4);
</pre><h2 id="27">b) Calculate the fundamental frequency of the "note" being played.</h2><pre class="codeinput"><span class="comment">% The fundamental frequency is calculated by finding the fourier transform</span>
<span class="comment">% or FFT of the bell sound and finding the frequency value with the first</span>
<span class="comment">% promiment peak. Any peaks that occur above this frequency are simply</span>
<span class="comment">% harmonics.</span>
<span class="comment">% (https://www.mathworks.com/help/matlab/math/fourier-transforms.html)</span>
m4 = length(y4);
n4 = pow2(nextpow2(m4));
y4fft = fft(y4, n4);
f4 = (0:n4)*fsamp4/n4;
power4 = abs(y4fft).^2/n4;

<span class="comment">%figure();</span>
<span class="comment">%plot(f4(1:floor(n4/2)),power4(1:floor(n4/2)));</span>

peaks4 = islocalmax(power4, <span class="string">'MinProminence'</span>, .5);
f04 = 0;
<span class="keyword">for</span> i = 1:length(peaks4)
    <span class="keyword">if</span>(peaks4(i) == 1)
        f04 = i*fsamp4/n4;
        <span class="keyword">break</span>;
    <span class="keyword">else</span>
        <span class="keyword">continue</span>;
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment">%%Explain how you can verify by listening that you have the correct fundamental frequency.</span>
<span class="comment">% Just by listening, we can verify that we have the correct fundamental</span>
<span class="comment">% frequency by varying the carrier and modulating function parameters to get higher</span>
<span class="comment">% and lower toned sounds and see if our fundamental frequency calcuation is</span>
<span class="comment">% also going up and down with the tone changes. We can also compare the sound of our created</span>
<span class="comment">% note with the sound of the calculated natural freqeuncy using an online tone generator.</span>
</pre><h2 id="28">c) Describe how you can hear the frequency content changing according to I(t)</h2><p>The frequency content is most modified by changing the Io value. Changing tau affects how quickly the sound decays within the duration and the duration obviously affects how long the sound plays in general. The interesting change is with Io where the lower the modulation index is the 'purer' the tone sounds. There are fewer reverberations and overtones/harmonics. The more we raise the Io value the more overtones and harmonics we hear.</p><pre class="codeinput"><span class="comment">%%Plot fi(t) versus t for comparison</span>
<span class="comment">% fi(t) = fc - I(t)*fm*sin(2pi*fm*t+phi_m) + dI/dt*cos(2*pi*fm*t+phi_m)</span>
<span class="comment">% (dI/dt = -1/tau * I0 * exp(-t/tau)</span>

<span class="comment">%defining terms</span>
Psi_m4 = -pi/2;
Psi_c4 = -pi/2;
t4 =  0:1/fsamp4:dur4;

I_t4 = Io4 * bellenv(tau4, dur4, fsamp4); <span class="comment">%call bell envelope function (exponential decay)</span>

<span class="comment">%calcualting fi_t</span>
fi_t4 = ff4(1,1) - I_t4.*ff4(1,2).*cos(2*pi*ff4(1,1)*t4+Io4*I_t4*-1/tau4.*cos(2*pi*ff4(1,2)*t4+Psi_m4)+Psi_c4);

<span class="comment">%All 6 cases will have their fi(t) plots plotted together on the same plot</span>
<span class="comment">%(fig 2) for comparison sake</span>

<span class="comment">%plotting normalized I(t) and fi(t)</span>
figure(2);
subplot(3,2,4)
plot(t4, fi_t4/max(fi_t4), <span class="string">'-b'</span>);
hold <span class="string">on</span>;
plot(t4, I_t4/max(I_t4), <span class="string">'-r'</span>);
hold <span class="string">off</span>;
title(<span class="string">'Case 4 fi(t) vs. t'</span>);
</pre><img vspace="5" hspace="5" src="main_14.png" alt=""> <h2 id="29">d) Display a spectrogram of the signal</h2><pre class="codeinput">figure();
plotspec(y4, fsamp4, 256);
title(<span class="string">'Case 4 Spectrogram'</span>);

<span class="comment">%%Describe how the frequency content changes, and how that change is related to I(t)</span>
<span class="comment">% The frequency content changes with I(t) by showing how long the harmonics</span>
<span class="comment">% and overtones last. We can see that the faster the decay rate or the</span>
<span class="comment">% larger tau is the sooner the frequency spectrum begins to have a</span>
<span class="comment">% diminshed influence from higher frequency aspects of the signal. Io also</span>
<span class="comment">% affects the plot by adding in higher frequency spectral lines. The</span>
<span class="comment">% higher the Io value the more harmonics or spectral lines we see on the graph.</span>

<span class="comment">%%Point out the "harmonic" structure of the spectrogram, and calculate the fundamental frequency, f0</span>
<span class="comment">% The fundamental frequency has been calculated at this point and the</span>
<span class="comment">% spectrogram shows that the fundamental frequency value is the one that</span>
<span class="comment">% has the strongest presence in the spectrogram at the end of the duration</span>
<span class="comment">% of the signal. The harmonic structure is seen with the spectral lines that</span>
<span class="comment">% show how at the beginning of the noise a large number of frequencies</span>
<span class="comment">% contribute to the sound but by the end of the sound we are left with the</span>
<span class="comment">% fundamental frequency and maybe the first or second harmonic.</span>

<span class="comment">%Case 4 fundamental frequency calculation result</span>
f04
</pre><pre class="codeoutput">
f04 =

  108.3389

</pre><img vspace="5" hspace="5" src="main_15.png" alt=""> <h2 id="30">e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv</h2><pre class="codeinput"><span class="comment">%recalculating A(t)</span>
A_t4 = bellenv(tau4, dur4, fsamp4);

<span class="comment">%plot the signal</span>
figure();
plot(y4);
set(gca,<span class="string">'FontSize'</span>,14); <span class="comment">%set font size</span>
title(<span class="string">'Case 4 Signal and A(t)'</span>,<span class="string">'FontSize'</span>,14); <span class="comment">%Title</span>
subtitle(<span class="string">'Signal = blue line A(t) = red line'</span>);
xlabel(<span class="string">'Time'</span>, <span class="string">'FontSize'</span>,14);<span class="comment">% X-axis Label</span>
ylabel(<span class="string">'Amplitude'</span>, <span class="string">'FontSize'</span>,14);<span class="comment">% Y-axis Label</span>
drawnow; <span class="comment">%ensure drawings are complete</span>
hold <span class="string">on</span>;
plot(A_t4, <span class="string">'-r'</span>, <span class="string">'LineWidth'</span>, 2);
hold <span class="string">off</span>;
</pre><img vspace="5" hspace="5" src="main_16.png" alt=""> <h2 id="31">f) Plot about 100&#8211;200 samples from the middle of the signal and explain what you see, especially the frequency variation.</h2><pre class="codeinput">figure();
plot(y4(100:1:300));
title(<span class="string">'Case 4 200 samples'</span>);

<span class="comment">% This view of 200 samples shows a pattern with one spaced out peak followed</span>
<span class="comment">% by three closely spaced peaks. This pattern shows that there are areas</span>
<span class="comment">% where a lower frequency is predominant and other areas where higher</span>
<span class="comment">% frequency aspects of the signal are showing up.</span>
</pre><img vspace="5" hspace="5" src="main_17.png" alt=""> <h2 id="32">Case 5 - fc=250 Hz; fm=350 Hz; I0=5; tau=2sec; dur=5sec; fs=11025;</h2><h2 id="33">a) Listen to sound by playing it with the soundsc function</h2><pre class="codeinput"><span class="comment">%run bell function and create array of values</span>

<span class="comment">% ff = frequency vector (containing fc and fm)</span>
ff5 = [250,350];
<span class="comment">% Io = scale factor for modulation index</span>
Io5 = 5;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau5 = 2;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur5 = 5;
<span class="comment">% fsamp = sampling rate</span>
fsamp5 = 11025;


y5 = bell(ff5,Io5,tau5,dur5,fsamp5);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y5, fsamp5);
</pre><h2 id="34">b) Calculate the fundamental frequency of the "note" being played.</h2><pre class="codeinput"><span class="comment">% The fundamental frequency is calculated by finding the fourier transform</span>
<span class="comment">% or FFT of the bell sound and finding the frequency value with the first</span>
<span class="comment">% promiment peak. Any peaks that occur above this frequency are simply</span>
<span class="comment">% harmonics.</span>
<span class="comment">% (https://www.mathworks.com/help/matlab/math/fourier-transforms.html)</span>
m5 = length(y5);
n5 = pow2(nextpow2(m5));
y5fft = fft(y5, n5);
f5 = (0:n5)*fsamp5/n5;
power5 = abs(y5fft).^2/n5;

<span class="comment">%figure();</span>
<span class="comment">%plot(f5(1:floor(n5/2)),power5(1:floor(n5/2)));</span>

peaks5 = islocalmax(power5, <span class="string">'MinProminence'</span>, .5);
f05 = 0;
<span class="keyword">for</span> i = 1:length(peaks5)
    <span class="keyword">if</span>(peaks5(i) == 1)
        f05 = i*fsamp5/n5;
        <span class="keyword">break</span>;
    <span class="keyword">else</span>
        <span class="keyword">continue</span>;
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment">%%Explain how you can verify by listening that you have the correct fundamental frequency.</span>
<span class="comment">% Just by listening, we can verify that we have the correct fundamental</span>
<span class="comment">% frequency by varying the carrier and modulating function parameters to get higher</span>
<span class="comment">% and lower toned sounds and see if our fundamental frequency calcuation is</span>
<span class="comment">% also going up and down with the tone changes. We can also compare the sound of our created</span>
<span class="comment">% note with the sound of the calculated natural freqeuncy using an online tone generator.</span>
</pre><h2 id="35">c) Describe how you can hear the frequency content changing according to I(t)</h2><p>The frequency content is most modified by changing the Io value. Changing tau affects how quickly the sound decays within the duration and the duration obviously affects how long the sound plays in general. The interesting change is with Io where the lower the modulation index is the 'purer' the tone sounds. There are fewer reverberations and overtones/harmonics. The more we raise the Io value the more overtones and harmonics we hear.</p><pre class="codeinput"><span class="comment">%%Plot fi(t) versus t for comparison</span>
<span class="comment">% fi(t) = fc - I(t)*fm*sin(2pi*fm*t+phi_m) + dI/dt*cos(2*pi*fm*t+phi_m)</span>
<span class="comment">% (dI/dt = -1/tau * I0 * exp(-t/tau)</span>

<span class="comment">%defining terms</span>
Psi_m5 = -pi/2;
Psi_c5 = -pi/2;
t5 =  0:1/fsamp5:dur5;

I_t5 = Io5 * bellenv(tau5, dur5, fsamp5); <span class="comment">%call bell envelope function (exponential decay)</span>

<span class="comment">%calcualting fi_t</span>
fi_t5 = ff5(1,1) - I_t5.*ff5(1,2).*cos(2*pi*ff5(1,1)*t5+Io5*I_t5*-1/tau5.*cos(2*pi*ff5(1,2)*t5+Psi_m5)+Psi_c5);

<span class="comment">%All 6 cases will have their fi(t) plots plotted together on the same plot</span>
<span class="comment">%(fig 2) for comparison sake</span>

<span class="comment">%plotting normalized I(t) and fi(t)</span>
figure(2);
subplot(3,2,5)
plot(t5, fi_t5/max(fi_t5), <span class="string">'-b'</span>);
hold <span class="string">on</span>;
plot(t5, I_t5/max(I_t5), <span class="string">'-r'</span>);
hold <span class="string">off</span>;
title(<span class="string">'Case 5 fi(t) vs. t'</span>);
</pre><img vspace="5" hspace="5" src="main_18.png" alt=""> <h2 id="36">d) Display a spectrogram of the signal</h2><pre class="codeinput">figure();
plotspec(y5, fsamp5, 256);
title(<span class="string">'Case 5 Spectrogram'</span>);

<span class="comment">%%Describe how the frequency content changes, and how that change is related to I(t)</span>
<span class="comment">% The frequency content changes with I(t) by showing how long the harmonics</span>
<span class="comment">% and overtones last. We can see that the faster the decay rate or the</span>
<span class="comment">% larger tau is the sooner the frequency spectrum begins to have a</span>
<span class="comment">% diminshed influence from higher frequency aspects of the signal. Io also</span>
<span class="comment">% affects the plot by adding in higher frequency spectral lines. The</span>
<span class="comment">% higher the Io value the more harmonics or spectral lines we see on the graph.</span>

<span class="comment">%%Point out the "harmonic" structure of the spectrogram, and calculate the fundamental frequency, f0</span>
<span class="comment">% The fundamental frequency has been calculated at this point and the</span>
<span class="comment">% spectrogram shows that the fundamental frequency value is the one that</span>
<span class="comment">% has the strongest presence in the spectrogram at the end of the duration</span>
<span class="comment">% of the signal. The harmonic structure is seen with the spectral lines that</span>
<span class="comment">% show how at the beginning of the noise a large number of frequencies</span>
<span class="comment">% contribute to the sound but by the end of the sound we are left with the</span>
<span class="comment">% fundamental frequency and maybe the first or second harmonic.</span>

<span class="comment">%Case 4 fundamental frequency calculation result</span>
f05
</pre><pre class="codeoutput">
f05 =

  100.0957

</pre><img vspace="5" hspace="5" src="main_19.png" alt=""> <h2 id="37">e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv</h2><pre class="codeinput"><span class="comment">%recalculating A(t)</span>
A_t5 = bellenv(tau5, dur5, fsamp5);

<span class="comment">%plot the signal</span>
figure();
plot(y5);
set(gca,<span class="string">'FontSize'</span>,14); <span class="comment">%set font size</span>
title(<span class="string">'Case 5 Signal and A(t)'</span>,<span class="string">'FontSize'</span>,14); <span class="comment">%Title</span>
subtitle(<span class="string">'Signal = blue line A(t) = red line'</span>);
xlabel(<span class="string">'Time'</span>, <span class="string">'FontSize'</span>,14);<span class="comment">% X-axis Label</span>
ylabel(<span class="string">'Amplitude'</span>, <span class="string">'FontSize'</span>,14);<span class="comment">% Y-axis Label</span>
drawnow; <span class="comment">%ensure drawings are complete</span>
hold <span class="string">on</span>;
plot(A_t5, <span class="string">'-r'</span>, <span class="string">'LineWidth'</span>, 2);
hold <span class="string">off</span>;
</pre><img vspace="5" hspace="5" src="main_20.png" alt=""> <h2 id="38">f) Plot about 100&#8211;200 samples from the middle of the signal and explain what you see, especially the frequency variation.</h2><pre class="codeinput">figure();
plot(y5(100:1:300));
title(<span class="string">'Case 5 200 samples'</span>);

<span class="comment">% This view of 200 samples doesn't show as much of a pattern. The principle</span>
<span class="comment">% of frequency modulation can still be seen however, with the signal</span>
<span class="comment">% changing amplitude with varying frequencies in the 200 sample window.</span>
</pre><img vspace="5" hspace="5" src="main_21.png" alt=""> <h2 id="39">Case 6 - fc=250 Hz; fm=350 Hz; I0=3; tau=1sec; dur=5sec; fs=11025;</h2><h2 id="40">a) Listen to sound by playing it with the soundsc function</h2><pre class="codeinput"><span class="comment">%run bell function and create array of values</span>

<span class="comment">% ff = frequency vector (containing fc and fm)</span>
ff6 = [250,350];
<span class="comment">% Io = scale factor for modulation index</span>
Io6 = 3;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau6 = 1;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur6 = 5;
<span class="comment">% fsamp = sampling rate</span>
fsamp6 = 11025;

y6 = bell(ff6,Io6,tau6,dur6,fsamp6);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y6, fsamp6);
</pre><h2 id="41">b) Calculate the fundamental frequency of the "note" being played.</h2><pre class="codeinput"><span class="comment">% The fundamental frequency is calculated by finding the fourier transform</span>
<span class="comment">% or FFT of the bell sound and finding the frequency value with the first</span>
<span class="comment">% promiment peak. Any peaks that occur above this frequency are simply</span>
<span class="comment">% harmonics.</span>
<span class="comment">% (https://www.mathworks.com/help/matlab/math/fourier-transforms.html)</span>
m6 = length(y6);
n6 = pow2(nextpow2(m6));
y6fft = fft(y6, n6);
f6 = (0:n6)*fsamp6/n6;
power6 = abs(y6fft).^2/n6;

<span class="comment">%figure();</span>
<span class="comment">%plot(f6(1:floor(n6/2)),power6(1:floor(n6/2)));</span>

peaks6 = islocalmax(power6, <span class="string">'MinProminence'</span>, .5);
f06 = 0;
<span class="keyword">for</span> i = 1:length(peaks6)
    <span class="keyword">if</span>(peaks6(i) == 1)
        f06 = i*fsamp6/n6;
        <span class="keyword">break</span>;
    <span class="keyword">else</span>
        <span class="keyword">continue</span>;
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment">%%Explain how you can verify by listening that you have the correct fundamental frequency.</span>
<span class="comment">% Just by listening, we can verify that we have the correct fundamental</span>
<span class="comment">% frequency by varying the carrier and modulating function parameters to get higher</span>
<span class="comment">% and lower toned sounds and see if our fundamental frequency calcuation is</span>
<span class="comment">% also going up and down with the tone changes. We can also compare the sound of our created</span>
<span class="comment">% note with the sound of the calculated natural freqeuncy using an online tone generator.</span>
</pre><h2 id="42">c) Describe how you can hear the frequency content changing according to I(t)</h2><p>The frequency content is most modified by changing the Io value. Changing tau affects how quickly the sound decays within the duration and the duration obviously affects how long the sound plays in general. The interesting change is with Io where the lower the modulation index is the 'purer' the tone sounds. There are fewer reverberations and overtones/harmonics. The more we raise the Io value the more overtones and harmonics we hear.</p><pre class="codeinput"><span class="comment">%%Plot fi(t) versus t for comparison</span>
<span class="comment">% fi(t) = fc - I(t)*fm*sin(2pi*fm*t+phi_m) + dI/dt*cos(2*pi*fm*t+phi_m)</span>
<span class="comment">% (dI/dt = -1/tau * I0 * exp(-t/tau)</span>

<span class="comment">%defining terms</span>
Psi_m6 = -pi/2;
Psi_c6 = -pi/2;
t6 =  0:1/fsamp6:dur6;

I_t6 = Io6 * bellenv(tau6, dur6, fsamp6); <span class="comment">%call bell envelope function (exponential decay)</span>

<span class="comment">%calcualting fi_t</span>
fi_t6 = ff6(1,1) - I_t6.*ff6(1,2).*cos(2*pi*ff6(1,1)*t6+Io6*I_t6*-1/tau6.*cos(2*pi*ff6(1,2)*t6+Psi_m6)+Psi_c6);

<span class="comment">%All 6 cases will have their fi(t) plots plotted together on the same plot</span>
<span class="comment">%(fig 2) for comparison sake</span>

<span class="comment">%plotting normalized I(t) and fi(t)</span>
figure(2);
subplot(3,2,6)
plot(t6, fi_t6/max(fi_t6), <span class="string">'-b'</span>);
hold <span class="string">on</span>;
plot(t6, I_t6/max(I_t6), <span class="string">'-r'</span>);
hold <span class="string">off</span>;
title(<span class="string">'Case 6 fi(t) vs. t'</span>);
</pre><img vspace="5" hspace="5" src="main_22.png" alt=""> <h2 id="43">d) Display a spectrogram of the signal</h2><pre class="codeinput">figure();
plotspec(y6, fsamp6, 256);
title(<span class="string">'Case 6 Spectrogram'</span>);

<span class="comment">%%Describe how the frequency content changes, and how that change is related to I(t)</span>
<span class="comment">% The frequency content changes with I(t) by showing how long the harmonics</span>
<span class="comment">% and overtones last. We can see that the faster the decay rate or the</span>
<span class="comment">% larger tau is the sooner the frequency spectrum begins to have a</span>
<span class="comment">% diminshed influence from higher frequency aspects of the signal. Io also</span>
<span class="comment">% affects the plot by adding in higher frequency spectral lines. The</span>
<span class="comment">% higher the Io value the more harmonics or spectral lines we see on the</span>
<span class="comment">% graph.</span>

<span class="comment">%%Point out the "harmonic" structure of the spectrogram, and calculate the fundamental frequency, f0</span>
<span class="comment">% The fundamental frequency has been calculated at this point and the</span>
<span class="comment">% spectrogram shows that the fundamental frequency value is the one that</span>
<span class="comment">% has the strongest presence in the spectrogram at the end of the duration</span>
<span class="comment">% of the signal. The harmonic structure is seen with the spectral lines that</span>
<span class="comment">% show how at the beginning of the noise a large number of frequencies</span>
<span class="comment">% contribute to the sound but by the end of the sound we are left with the</span>
<span class="comment">% fundamental frequency and maybe the first or second harmonic.</span>

<span class="comment">%Case 6 fundamental frequency calculation result</span>
f06
</pre><pre class="codeoutput">
f06 =

  100.0957

</pre><img vspace="5" hspace="5" src="main_23.png" alt=""> <h2 id="44">e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv</h2><pre class="codeinput"><span class="comment">%recalculating A(t)</span>
A_t6 = bellenv(tau6, dur6, fsamp6);

<span class="comment">%plot the signal</span>
figure();
plot(y6);
set(gca,<span class="string">'FontSize'</span>,14); <span class="comment">%set font size</span>
title(<span class="string">'Case 6 Signal and A(t)'</span>,<span class="string">'FontSize'</span>,14); <span class="comment">%Title</span>
subtitle(<span class="string">'Signal = blue line A(t) = red line'</span>);
xlabel(<span class="string">'Time'</span>, <span class="string">'FontSize'</span>,14);<span class="comment">% X-axis Label</span>
ylabel(<span class="string">'Amplitude'</span>, <span class="string">'FontSize'</span>,14);<span class="comment">% Y-axis Label</span>
drawnow; <span class="comment">%ensure drawings are complete</span>
hold <span class="string">on</span>;
plot(A_t6, <span class="string">'-r'</span>, <span class="string">'LineWidth'</span>, 2);
hold <span class="string">off</span>;
</pre><img vspace="5" hspace="5" src="main_24.png" alt=""> <h2 id="45">f) Plot about 100&#8211;200 samples from the middle of the signal and explain what you see, especially the frequency variation.</h2><pre class="codeinput">figure();
plot(y6(100:1:300));
title(<span class="string">'Case 6 200 samples'</span>);

<span class="comment">% This view of 200 samples doesn't show as much of a pattern. The principle</span>
<span class="comment">% of frequency modulation can still be seen however, with the signal</span>
<span class="comment">% changing amplitude with varying frequencies in the 200 sample window.</span>
</pre><img vspace="5" hspace="5" src="main_25.png" alt=""> <h2 id="46">4.4 Modifying the Fundamental Frequency</h2><h2 id="47">Test 1: Fc = 50 and Fm = 100 =&gt; F0 ~ 50</h2><p>ff = frequency vector (containing fc and fm)</p><pre class="codeinput">ff1 = [50,100];
<span class="comment">% Io = scale factor for modulation index</span>
Io1 = 10;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau1 = 2;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur1 = 6;
<span class="comment">% fsamp = sampling rate</span>
fsamp1 = 11025;


y1 = bell(ff1,Io1,tau1,dur1,fsamp1);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y1, fsamp1);

<span class="comment">%%Describe what you hear:</span>
<span class="comment">% In this test the pitch was very low and the sound seemed to decay or end</span>
<span class="comment">% realtively quick.</span>
</pre><h2 id="48">Test 2: fc = 200 fm = 400 =&gt; F0 ~ 200</h2><p>ff = frequency vector (containing fc and fm)</p><pre class="codeinput">ff2 = [200,400];
<span class="comment">% Io = scale factor for modulation index</span>
Io2 = 10;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau2 = 2;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur2 = 6;
<span class="comment">% fsamp = sampling rate</span>
fsamp2 = 11025;


y2 = bell(ff2,Io2,tau2,dur2,fsamp2);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y2, fsamp2);

<span class="comment">%%Describe what you hear:</span>
<span class="comment">% In this test the pitch was was at a comfortable level and the sound seemed</span>
<span class="comment">% to decay relatively slow.</span>
</pre><h2 id="49">Test 3: fc = 400 fm = 800 =&gt; F0 ~ 400</h2><p>ff = frequency vector (containing fc and fm)</p><pre class="codeinput">ff3 = [400,800];
<span class="comment">% Io = scale factor for modulation index</span>
Io3 = 10;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau3 = 2;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur3 = 6;
<span class="comment">% fsamp = sampling rate</span>
fsamp3 = 11025;


y3 = bell(ff3,Io3,tau3,dur3,fsamp3);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y3, fsamp3);
</pre><h2 id="50">Test 4: fc = 800 fm = 1600 =&gt; F0 ~ 800</h2><p>ff = frequency vector (containing fc and fm)</p><pre class="codeinput">ff4 = [800,1600];
<span class="comment">% Io = scale factor for modulation index</span>
Io4 = 10;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau4 = 2;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur4 = 6;
<span class="comment">% fsamp = sampling rate</span>
fsamp4 = 11025;


y4 = bell(ff4,Io4,tau4,dur4,fsamp4);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y4, fsamp4);

<span class="comment">%%Describe what you hear:</span>
<span class="comment">% In this test the pitch was was at a very high level and the overtones</span>
<span class="comment">% were not very pleasant to listen to. The harmonics or overtones decayed</span>
<span class="comment">% quickly but the fundamental frequency seemed to decay at a slower rate.</span>
</pre><h2 id="51">Frequency Modulation Ratio Tests</h2><h2 id="52">Test 1: 5:7 Ratio (f0 = 40)</h2><p>ff = frequency vector (containing fc and fm)</p><pre class="codeinput">ff5 = [200, 280];
<span class="comment">% Io = scale factor for modulation index</span>
Io5 = 10;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau5 = 2;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur5 = 6;
<span class="comment">% fsamp = sampling rate</span>
fsamp5 = 11025;


y5 = bell(ff5,Io5,tau5,dur5,fsamp5);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y5, fsamp5);
</pre><h2 id="53">Test 2: 7:5 Ratio (f0 = 40)</h2><p>ff = frequency vector (containing fc and fm)</p><pre class="codeinput">ff6 = [280,200];
<span class="comment">% Io = scale factor for modulation index</span>
Io6 = 10;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau6 = 2;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur6 = 6;
<span class="comment">% fsamp = sampling rate</span>
fsamp6 = 11025;


y6 = bell(ff6,Io6,tau6,dur6,fsamp6);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y6, fsamp6);
</pre><h2 id="54">Test 3: 1:6</h2><p>ff = frequency vector (containing fc and fm)</p><pre class="codeinput">ff7 = [110,610];
<span class="comment">% Io = scale factor for modulation index</span>
Io7 = 10;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau7 = 2;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur7 = 6;
<span class="comment">% fsamp = sampling rate</span>
fsamp7 = 11025;


y7 = bell(ff7,Io7,tau7,dur7,fsamp7);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y7, fsamp7);
</pre><h2 id="55">Test 4: 7:11 Ratio</h2><p>ff = frequency vector (containing fc and fm)</p><pre class="codeinput">ff8 = [700,1100];
<span class="comment">% Io = scale factor for modulation index</span>
Io8 = 10;
<span class="comment">% tau = decay parameter for A(t) and I(t)</span>
tau8 = 2;
<span class="comment">% dur = duration (in sec.) of the output signal</span>
dur8 = 6;
<span class="comment">% fsamp = sampling rate</span>
fsamp8 = 11025;


y8 = bell(ff8,Io8,tau8,dur8,fsamp8);

<span class="comment">%play the sound (array and sampling rate)</span>
soundsc(y8, fsamp8);
</pre><h2 id="56">Which parameters sound best?</h2><pre class="codeinput"><span class="comment">% I think that the 5:7 or 1:2 ratios sound the best. With ratios that have</span>
<span class="comment">% the carrier frequency greater than the modulating frequency the sound</span>
<span class="comment">% seems clunky and like it interferes with itself. The 7:11 ratio had so</span>
<span class="comment">% many tones in it that it was hard to listen to.</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2022b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% 4.1 Generating the Bell Envelopes
%See bellenv.m for details on function construction

%% 4.2 Parameters for the Bell
%See bell.m for details on how the bell sound function is constructed

%% 4.3 The Bell Sound

%% Case 1 - fc=110 Hz; fm=220 Hz; I0=10; tau=2sec; dur=6sec; fs=11025;
%% a) Listen to sound by playing it with the soundsc function
%run bell function and create array of values

% ff = frequency vector (containing fc and fm)
ff1 = [110,220];
% Io = scale factor for modulation index
Io1 = 10;
% tau = decay parameter for A(t) and I(t)
tau1 = 2;
% dur = duration (in sec.) of the output signal
dur1 = 6;
% fsamp = sampling rate
fsamp1 = 11025;


y1 = bell(ff1,Io1,tau1,dur1,fsamp1);

%play the sound (array and sampling rate)
soundsc(y1, fsamp1);

%% b) Calculate the fundamental frequency of the "note" being played. 

% The fundamental frequency is calculated by finding the fourier transform
% or FFT of the bell sound and finding the frequency value with the first
% promiment peak. Any peaks that occur above this frequency are simply 
% harmonics.  
% (https://www.mathworks.com/help/matlab/math/fourier-transforms.html)
m1 = length(y1);
n1 = pow2(nextpow2(m1));
y1fft = fft(y1, n1);
f1 = (0:n1)*fsamp1/n1;
power1 = abs(y1fft).^2/n1;

%figure();
%plot(f1(1:floor(n1/2)),power1(1:floor(n1/2)));

peaks1 = islocalmax(power1, 'MinProminence', 1);
f01 = 0;
for i = 1:length(peaks1)
    if(peaks1(i) == 1)
        f01 = i*fsamp1/n1;
        break;
    else
        continue;
    end
end


%%Explain how you can verify by listening that you have the correct fundamental frequency.
% Just by listening, we can verify that we have the correct fundamental
% frequency by varying the carrier and modulating function parameters to get higher
% and lower toned sounds and see if our fundamental frequency calcuation is
% also going up and down with the tone changes. We can also compare the sound of our created
% note with the sound of the calculated natural freqeuncy using an online tone generator. 


%% c) Describe how you can hear the frequency content changing according to I(t)
% The frequency content is most modified by changing the Io value. Changing
% tau affects how quickly the sound decays within the duration and the
% duration obviously affects how long the sound plays in general. The
% interesting change is with Io where the lower the modulation index is the
% 'purer' the tone sounds. There are fewer reverberations and
% overtones/harmonics. The more we raise the Io value the more overtones
% and harmonics we hear. 

%%Plot fi(t) versus t for comparison
% fi(t) = fc - I(t)*fm*sin(2pi*fm*t+phi_m) + dI/dt*cos(2*pi*fm*t+phi_m)
% (dI/dt = -1/tau * I0 * exp(-t/tau)

%defining terms
Psi_m1 = -pi/2;
Psi_c1 = -pi/2;
t1 =  0:1/fsamp1:dur1;

I_t1 = Io1 * bellenv(tau1, dur1, fsamp1); %call bell envelope function (exponential decay)

%calcualting fi_t
fi_t1 = ff1(1,1) - I_t1.*ff1(1,2).*cos(2*pi*ff1(1,1)*t1+Io1*I_t1*-1/tau1.*cos(2*pi*ff1(1,2)*t1+Psi_m1)+Psi_c1);

%All 6 cases will have their fi(t) plots plotted together on the same plot
%for comparison sake

%plotting normalized I(t) and fi(t)
figure(2);
subplot(3,2,1)
plot(t1, fi_t1/max(fi_t1), '-b');
hold on;
plot(t1, I_t1/max(I_t1), '-r');
hold off;
title('Case 1 fi(t) vs. t');

figure();
plot(t1, fi_t1/max(fi_t1), '-b');
hold on;
plot(t1, I_t1/max(I_t1), '-r');
hold off;
title('Case 1 fi(t) vs. t');
%% d) Display a spectrogram of the signal

figure();
plotspec(y1, fsamp1, 256);
title('Case 1 Spectrogram');

%%Describe how the frequency content changes, and how that change is related to I(t)
% The frequency content changes with I(t) by showing how long the harmonics
% and overtones last. We can see that the faster the decay rate or the
% larger tau is the sooner the frequency spectrum begins to have a
% diminshed influence from higher frequency aspects of the signal. Io also
% affects the plot by adding in higher frequency spectral lines. The
% higher the Io value the more harmonics or spectral lines we see on the graph. 

%%Point out the "harmonic" structure of the spectrogram, and calculate the fundamental frequency, f0
% The fundamental frequency has been calculated at this point and the
% spectrogram shows that the fundamental frequency value is the one that
% has the strongest presence in the spectrogram at the end of the duration
% of the signal. The harmonic structure is seen with the spectral lines that 
% show how at the beginning of the noise a large number of frequencies
% contribute to the sound but by the end of the sound we are left with the
% fundamental frequency and maybe the first or second harmonic. 

%Case 1 fundamental frequency calculation result
f01

%% e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv

%recalculating A(t)
A_t1 = bellenv(tau1, dur1, fsamp1);

%plot the signal
figure();
plot(y1);
set(gca,'FontSize',14); %set font size
title('Case 1 Signal and A(t)','FontSize',14); %Title
subtitle('Signal = blue line A(t) = red line');
xlabel('Time', 'FontSize',14);% X-axis Label
ylabel('Amplitude', 'FontSize',14);% Y-axis Label
drawnow; %ensure drawings are complete
hold on;
plot(A_t1, '-r', 'LineWidth', 2);
hold off;

%% f) Plot about 100–200 samples from the middle of the signal and explain what you see, especially the frequency variation.

figure();
plot(y1(100:1:300));
title('Case 1 200 samples');

% This view of 200 samples shows a pattern with one spaced out peak followed 
% by three closely spaced peaks. This pattern shows that there are areas 
% where a lower frequency is predominant and other areas where higher 
% frequency aspects of the signal are showing up. 

%% Case 2 - fc=220 Hz; fm=440 Hz; I0=5; tau=2sec; dur=6sec; fs=11025;
%% a) Listen to sound by playing it with the soundsc function
%run bell function and create array of values

% ff = frequency vector (containing fc and fm)
ff2 = [220,440];
% Io = scale factor for modulation index
Io2 = 5;
% tau = decay parameter for A(t) and I(t)
tau2 = 2;
% dur = duration (in sec.) of the output signal
dur2 = 6;
% fsamp = sampling rate
fsamp2 = 11025;


y2 = bell(ff2,Io2,tau2,dur2,fsamp2);

%play the sound (array and sampling rate)
soundsc(y2, fsamp2);
%% b) Calculate the fundamental frequency of the "note" being played. 

% The fundamental frequency is calculated by finding the fourier transform
% or FFT of the bell sound and finding the frequency value with the first
% promiment peak. Any peaks that occur above this frequency are simply 
% harmonics.
% (https://www.mathworks.com/help/matlab/math/fourier-transforms.html)
m2 = length(y2);
n2 = pow2(nextpow2(m2));
y2fft = fft(y2, n2);
f2 = (0:n2)*fsamp2/n2;
power2 = abs(y2fft).^2/n2;

%figure();
%plot(f2(1:floor(n2/2)),power2(1:floor(n2/2)));

peaks2 = islocalmax(power2, 'MinProminence', 1);
f02 = 0;
for i = 1:length(peaks2)
    if(peaks2(i) == 1)
        f02 = i*fsamp2/n2;
        break;
    else
        continue;
    end
end

%%Explain how you can verify by listening that you have the correct fundamental frequency.
% Just by listening, we can verify that we have the correct fundamental
% frequency by varying the carrier and modulating function parameters to get higher
% and lower toned sounds and see if our fundamental frequency calcuation is
% also going up and down with the tone changes. We can also compare the sound of our created
% note with the sound of the calculated natural freqeuncy using an online tone generator.

%% c) Describe how you can hear the frequency content changing according to I(t)
% The frequency content is most modified by changing the Io value. Changing
% tau affects how quickly the sound decays within the duration and the
% duration obviously affects how long the sound plays in general. The
% interesting change is with Io where the lower the modulation index is the
% 'purer' the tone sounds. There are fewer reverberations and
% overtones/harmonics. The more we raise the Io value the more overtones
% and harmonics we hear. 

%%Plot fi(t) versus t for comparison
% fi(t) = fc - I(t)*fm*sin(2pi*fm*t+phi_m) + dI/dt*cos(2*pi*fm*t+phi_m)
% (dI/dt = -1/tau * I0 * exp(-t/tau)

%defining terms
Psi_m2 = -pi/2;
Psi_c2 = -pi/2;
t2 =  0:1/fsamp1:dur1;

I_t2 = Io2 * bellenv(tau2, dur2, fsamp2); %call bell envelope function (exponential decay)

%calcualting fi_t
fi_t2 = ff2(1,1) - I_t2.*ff2(1,2).*cos(2*pi*ff2(1,1)*t2+Io2*I_t2*-1/tau2.*cos(2*pi*ff2(1,2)*t2+Psi_m2)+Psi_c2);

%All 6 cases will have their fi(t) plots plotted together on the same plot
%for comparison sake

%plotting normalized I(t) and fi(t)
figure(2);
subplot(3,2,2)
plot(t2, fi_t2/max(fi_t2), '-b');
hold on;
plot(t2, I_t2/max(I_t2), '-r');
hold off;
title('Case 2 fi(t) vs. t');

%% d) Display a spectrogram of the signal

figure();
plotspec(y2, fsamp2, 256);
title('Case 2 Spectrogram');

%%Describe how the frequency content changes, and how that change is related to I(t)
% The frequency content changes with I(t) by showing how long the harmonics
% and overtones last. We can see that the faster the decay rate or the
% larger tau is the sooner the frequency spectrum begins to have a
% diminshed influence from higher frequency aspects of the signal. Io also
% affects the plot by adding in higher frequency spectral lines. The
% higher the Io value the more harmonics or spectral lines we see on the graph. 

%%Point out the "harmonic" structure of the spectrogram, and calculate the fundamental frequency, f0
% The fundamental frequency has been calculated at this point and the
% spectrogram shows that the fundamental frequency value is the one that
% has the strongest presence in the spectrogram at the end of the duration
% of the signal. The harmonic structure is seen with the spectral lines that 
% show how at the beginning of the noise a large number of frequencies
% contribute to the sound but by the end of the sound we are left with the
% fundamental frequency and maybe the first or second harmonic. 

%Case 2 fundamental frequency calculation result
f02

%% e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv

%recalculating A(t)
A_t2 = bellenv(tau2, dur2, fsamp2);

%plot the signal
figure();
plot(y2);
set(gca,'FontSize',14); %set font size
title('Case 2 Signal and A(t)','FontSize',14); %Title
subtitle('Signal = blue line A(t) = red line');
xlabel('Time', 'FontSize',14);% X-axis Label
ylabel('Amplitude', 'FontSize',14);% Y-axis Label
drawnow; %ensure drawings are complete
hold on;
plot(A_t2, '-r', 'LineWidth', 2);
hold off;

%% f) Plot about 100–200 samples from the middle of the signal and explain what you see, especially the frequency variation.

figure();
plot(y2(100:1:300));
title('Case 2 200 samples');

% This view of 200 samples shows a pattern with one spaced out peak followed 
% by three closely spaced peaks. This pattern shows that there are areas 
% where a lower frequency is predominant and other areas where higher 
% frequency aspects of the signal are showing up.

%% Case 3 - fc=110 Hz; fm=220 Hz; I0=10; tau=12sec; dur=3sec; fs=11025;
%% a) Listen to sound by playing it with the soundsc function
%run bell function and create array of values

% ff = frequency vector (containing fc and fm)
ff3 = [110,220];
% Io = scale factor for modulation index
Io3 = 10;
% tau = decay parameter for A(t) and I(t)
tau3 = 12;
% dur = duration (in sec.) of the output signal
dur3 = 3;
% fsamp = sampling rate
fsamp3 = 11025;

y3 = bell(ff3,Io3,tau3,dur3,fsamp3);

%play the sound (array and sampling rate)
soundsc(y3, fsamp3);

%% b) Calculate the fundamental frequency of the "note" being played. 

% The fundamental frequency is calculated by finding the fourier transform
% or FFT of the bell sound and finding the frequency value with the first
% promiment peak. Any peaks that occur above this frequency are simply 
% harmonics. 
% (https://www.mathworks.com/help/matlab/math/fourier-transforms.html)
m3 = length(y3);
n3 = pow2(nextpow2(m3));
y3fft = fft(y3, n3);
f3 = (0:n3)*fsamp3/n3;
power3 = abs(y3fft).^2/n3;

%figure();
%plot(f3(1:floor(n3/2)),power3(1:floor(n3/2)));

peaks3 = islocalmax(power3, 'MinProminence', 1);
f03 = 0;
for i = 1:length(peaks3)
    if(peaks3(i) == 1)
        f03 = i*fsamp3/n3;
        break;
    else
        continue;
    end
end

%%Explain how you can verify by listening that you have the correct fundamental frequency.
% Just by listening, we can verify that we have the correct fundamental
% frequency by varying the carrier and modulating function parameters to get higher
% and lower toned sounds and see if our fundamental frequency calcuation is
% also going up and down with the tone changes. We can also compare the sound of our created
% note with the sound of the calculated natural freqeuncy using an online tone generator.

%% c) Describe how you can hear the frequency content changing according to I(t)
% The frequency content is most modified by changing the Io value. Changing
% tau affects how quickly the sound decays within the duration and the
% duration obviously affects how long the sound plays in general. The
% interesting change is with Io where the lower the modulation index is the
% 'purer' the tone sounds. There are fewer reverberations and
% overtones/harmonics. The more we raise the Io value the more overtones
% and harmonics we hear. 

%%Plot fi(t) versus t for comparison
% fi(t) = fc - I(t)*fm*sin(2pi*fm*t+phi_m) + dI/dt*cos(2*pi*fm*t+phi_m)
% (dI/dt = -1/tau * I0 * exp(-t/tau)

%defining terms
Psi_m3 = -pi/2;
Psi_c3 = -pi/2;
t3 =  0:1/fsamp3:dur3;

I_t3 = Io3 * bellenv(tau3, dur3, fsamp3); %call bell envelope function (exponential decay)

%calcualting fi_t
fi_t3 = ff3(1,1) - I_t3.*ff3(1,2).*cos(2*pi*ff3(1,1)*t3+Io3*I_t3*-1/tau3.*cos(2*pi*ff3(1,2)*t3+Psi_m3)+Psi_c3);

%All 6 cases will have their fi(t) plots plotted together on the same plot
%for comparison sake

%plotting normalized I(t) and fi(t)
figure(2);
subplot(3,2,3)
plot(t3, fi_t3/max(fi_t3), '-b');
hold on;
plot(t3, I_t3/max(I_t3), '-r');
hold off;
title('Case 3 fi(t) vs. t');

%% d) Display a spectrogram of the signal

figure();
plotspec(y3, fsamp3, 256);
title('Case 3 Spectrogram');

%%Describe how the frequency content changes, and how that change is related to I(t)
% The frequency content changes with I(t) by showing how long the harmonics
% and overtones last. We can see that the faster the decay rate or the
% larger tau is the sooner the frequency spectrum begins to have a
% diminshed influence from higher frequency aspects of the signal. Io also
% affects the plot by adding in higher frequency spectral lines. The
% higher the Io value the more harmonics or spectral lines we see on the graph. 

%%Point out the "harmonic" structure of the spectrogram, and calculate the fundamental frequency, f0
% The fundamental frequency has been calculated at this point and the
% spectrogram shows that the fundamental frequency value is the one that
% has the strongest presence in the spectrogram at the end of the duration
% of the signal. The harmonic structure is seen with the spectral lines that 
% show how at the beginning of the noise a large number of frequencies
% contribute to the sound but by the end of the sound we are left with the
% fundamental frequency and maybe the first or second harmonic. 

%Case 3 fundamental frequency calculation result
f03

%% e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv

%recalculating A(t)
A_t3 = bellenv(tau3, dur3, fsamp3);

%plot the signal
figure();
plot(y3);
set(gca,'FontSize',14); %set font size
title('Case 3 Signal and A(t)','FontSize',14); %Title
subtitle('Signal = blue line A(t) = red line');
xlabel('Time', 'FontSize',14);% X-axis Label
ylabel('Amplitude', 'FontSize',14);% Y-axis Label
drawnow; %ensure drawings are complete
hold on;
plot(A_t3, '-r', 'LineWidth', 2);
hold off;

%% f) Plot about 100–200 samples from the middle of the signal and explain what you see, especially the frequency variation.

figure();
plot(y3(100:1:300));
title('Case 3 200 samples');

% This view of 200 samples shows a pattern with one spaced out peak followed 
% by three closely spaced peaks. This pattern shows that there are areas 
% where a lower frequency is predominant and other areas where higher 
% frequency aspects of the signal are showing up.

%% Case 4 - fc=110 Hz; fm=220 Hz; I0=10; tau=.3sec; dur=3sec; fs=11025;
%% a) Listen to sound by playing it with the soundsc function
%run bell function and create array of values

% ff = frequency vector (containing fc and fm)
ff4 = [110,220];
% Io = scale factor for modulation index
Io4 = 10;
% tau = decay parameter for A(t) and I(t)
tau4 = .3;
% dur = duration (in sec.) of the output signal
dur4 = 3;
% fsamp = sampling rate
fsamp4 = 11025;


y4 = bell(ff4,Io4,tau4,dur4,fsamp4);

%play the sound (array and sampling rate)
soundsc(y4, fsamp4);

%% b) Calculate the fundamental frequency of the "note" being played. 

% The fundamental frequency is calculated by finding the fourier transform
% or FFT of the bell sound and finding the frequency value with the first
% promiment peak. Any peaks that occur above this frequency are simply 
% harmonics. 
% (https://www.mathworks.com/help/matlab/math/fourier-transforms.html)
m4 = length(y4);
n4 = pow2(nextpow2(m4));
y4fft = fft(y4, n4);
f4 = (0:n4)*fsamp4/n4;
power4 = abs(y4fft).^2/n4;

%figure();
%plot(f4(1:floor(n4/2)),power4(1:floor(n4/2)));

peaks4 = islocalmax(power4, 'MinProminence', .5);
f04 = 0;
for i = 1:length(peaks4)
    if(peaks4(i) == 1)
        f04 = i*fsamp4/n4;
        break;
    else
        continue;
    end
end

%%Explain how you can verify by listening that you have the correct fundamental frequency.
% Just by listening, we can verify that we have the correct fundamental
% frequency by varying the carrier and modulating function parameters to get higher
% and lower toned sounds and see if our fundamental frequency calcuation is
% also going up and down with the tone changes. We can also compare the sound of our created
% note with the sound of the calculated natural freqeuncy using an online tone generator.

%% c) Describe how you can hear the frequency content changing according to I(t)
% The frequency content is most modified by changing the Io value. Changing
% tau affects how quickly the sound decays within the duration and the
% duration obviously affects how long the sound plays in general. The
% interesting change is with Io where the lower the modulation index is the
% 'purer' the tone sounds. There are fewer reverberations and
% overtones/harmonics. The more we raise the Io value the more overtones
% and harmonics we hear. 

%%Plot fi(t) versus t for comparison
% fi(t) = fc - I(t)*fm*sin(2pi*fm*t+phi_m) + dI/dt*cos(2*pi*fm*t+phi_m)
% (dI/dt = -1/tau * I0 * exp(-t/tau)

%defining terms
Psi_m4 = -pi/2;
Psi_c4 = -pi/2;
t4 =  0:1/fsamp4:dur4;

I_t4 = Io4 * bellenv(tau4, dur4, fsamp4); %call bell envelope function (exponential decay)

%calcualting fi_t
fi_t4 = ff4(1,1) - I_t4.*ff4(1,2).*cos(2*pi*ff4(1,1)*t4+Io4*I_t4*-1/tau4.*cos(2*pi*ff4(1,2)*t4+Psi_m4)+Psi_c4);

%All 6 cases will have their fi(t) plots plotted together on the same plot
%(fig 2) for comparison sake

%plotting normalized I(t) and fi(t)
figure(2);
subplot(3,2,4)
plot(t4, fi_t4/max(fi_t4), '-b');
hold on;
plot(t4, I_t4/max(I_t4), '-r');
hold off;
title('Case 4 fi(t) vs. t');

%% d) Display a spectrogram of the signal

figure();
plotspec(y4, fsamp4, 256);
title('Case 4 Spectrogram');

%%Describe how the frequency content changes, and how that change is related to I(t)
% The frequency content changes with I(t) by showing how long the harmonics
% and overtones last. We can see that the faster the decay rate or the
% larger tau is the sooner the frequency spectrum begins to have a
% diminshed influence from higher frequency aspects of the signal. Io also
% affects the plot by adding in higher frequency spectral lines. The
% higher the Io value the more harmonics or spectral lines we see on the graph. 

%%Point out the "harmonic" structure of the spectrogram, and calculate the fundamental frequency, f0
% The fundamental frequency has been calculated at this point and the
% spectrogram shows that the fundamental frequency value is the one that
% has the strongest presence in the spectrogram at the end of the duration
% of the signal. The harmonic structure is seen with the spectral lines that 
% show how at the beginning of the noise a large number of frequencies
% contribute to the sound but by the end of the sound we are left with the
% fundamental frequency and maybe the first or second harmonic. 

%Case 4 fundamental frequency calculation result
f04

%% e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv

%recalculating A(t)
A_t4 = bellenv(tau4, dur4, fsamp4);

%plot the signal
figure();
plot(y4);
set(gca,'FontSize',14); %set font size
title('Case 4 Signal and A(t)','FontSize',14); %Title
subtitle('Signal = blue line A(t) = red line');
xlabel('Time', 'FontSize',14);% X-axis Label
ylabel('Amplitude', 'FontSize',14);% Y-axis Label
drawnow; %ensure drawings are complete
hold on;
plot(A_t4, '-r', 'LineWidth', 2);
hold off;

%% f) Plot about 100–200 samples from the middle of the signal and explain what you see, especially the frequency variation.

figure();
plot(y4(100:1:300));
title('Case 4 200 samples');

% This view of 200 samples shows a pattern with one spaced out peak followed 
% by three closely spaced peaks. This pattern shows that there are areas 
% where a lower frequency is predominant and other areas where higher 
% frequency aspects of the signal are showing up.

%% Case 5 - fc=250 Hz; fm=350 Hz; I0=5; tau=2sec; dur=5sec; fs=11025;
%% a) Listen to sound by playing it with the soundsc function
%run bell function and create array of values

% ff = frequency vector (containing fc and fm)
ff5 = [250,350];
% Io = scale factor for modulation index
Io5 = 5;
% tau = decay parameter for A(t) and I(t)
tau5 = 2;
% dur = duration (in sec.) of the output signal
dur5 = 5;
% fsamp = sampling rate
fsamp5 = 11025;


y5 = bell(ff5,Io5,tau5,dur5,fsamp5);

%play the sound (array and sampling rate)
soundsc(y5, fsamp5);

%% b) Calculate the fundamental frequency of the "note" being played. 

% The fundamental frequency is calculated by finding the fourier transform
% or FFT of the bell sound and finding the frequency value with the first
% promiment peak. Any peaks that occur above this frequency are simply 
% harmonics. 
% (https://www.mathworks.com/help/matlab/math/fourier-transforms.html)
m5 = length(y5);
n5 = pow2(nextpow2(m5));
y5fft = fft(y5, n5);
f5 = (0:n5)*fsamp5/n5;
power5 = abs(y5fft).^2/n5;

%figure();
%plot(f5(1:floor(n5/2)),power5(1:floor(n5/2)));

peaks5 = islocalmax(power5, 'MinProminence', .5);
f05 = 0;
for i = 1:length(peaks5)
    if(peaks5(i) == 1)
        f05 = i*fsamp5/n5;
        break;
    else
        continue;
    end
end

%%Explain how you can verify by listening that you have the correct fundamental frequency.
% Just by listening, we can verify that we have the correct fundamental
% frequency by varying the carrier and modulating function parameters to get higher
% and lower toned sounds and see if our fundamental frequency calcuation is
% also going up and down with the tone changes. We can also compare the sound of our created
% note with the sound of the calculated natural freqeuncy using an online tone generator.

%% c) Describe how you can hear the frequency content changing according to I(t)
% The frequency content is most modified by changing the Io value. Changing
% tau affects how quickly the sound decays within the duration and the
% duration obviously affects how long the sound plays in general. The
% interesting change is with Io where the lower the modulation index is the
% 'purer' the tone sounds. There are fewer reverberations and
% overtones/harmonics. The more we raise the Io value the more overtones
% and harmonics we hear. 

%%Plot fi(t) versus t for comparison
% fi(t) = fc - I(t)*fm*sin(2pi*fm*t+phi_m) + dI/dt*cos(2*pi*fm*t+phi_m)
% (dI/dt = -1/tau * I0 * exp(-t/tau)

%defining terms
Psi_m5 = -pi/2;
Psi_c5 = -pi/2;
t5 =  0:1/fsamp5:dur5;

I_t5 = Io5 * bellenv(tau5, dur5, fsamp5); %call bell envelope function (exponential decay)

%calcualting fi_t
fi_t5 = ff5(1,1) - I_t5.*ff5(1,2).*cos(2*pi*ff5(1,1)*t5+Io5*I_t5*-1/tau5.*cos(2*pi*ff5(1,2)*t5+Psi_m5)+Psi_c5);

%All 6 cases will have their fi(t) plots plotted together on the same plot
%(fig 2) for comparison sake

%plotting normalized I(t) and fi(t)
figure(2);
subplot(3,2,5)
plot(t5, fi_t5/max(fi_t5), '-b');
hold on;
plot(t5, I_t5/max(I_t5), '-r');
hold off;
title('Case 5 fi(t) vs. t');

%% d) Display a spectrogram of the signal

figure();
plotspec(y5, fsamp5, 256);
title('Case 5 Spectrogram');

%%Describe how the frequency content changes, and how that change is related to I(t)
% The frequency content changes with I(t) by showing how long the harmonics
% and overtones last. We can see that the faster the decay rate or the
% larger tau is the sooner the frequency spectrum begins to have a
% diminshed influence from higher frequency aspects of the signal. Io also
% affects the plot by adding in higher frequency spectral lines. The
% higher the Io value the more harmonics or spectral lines we see on the graph. 

%%Point out the "harmonic" structure of the spectrogram, and calculate the fundamental frequency, f0
% The fundamental frequency has been calculated at this point and the
% spectrogram shows that the fundamental frequency value is the one that
% has the strongest presence in the spectrogram at the end of the duration
% of the signal. The harmonic structure is seen with the spectral lines that 
% show how at the beginning of the noise a large number of frequencies
% contribute to the sound but by the end of the sound we are left with the
% fundamental frequency and maybe the first or second harmonic. 

%Case 4 fundamental frequency calculation result
f05

%% e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv

%recalculating A(t)
A_t5 = bellenv(tau5, dur5, fsamp5);

%plot the signal
figure();
plot(y5);
set(gca,'FontSize',14); %set font size
title('Case 5 Signal and A(t)','FontSize',14); %Title
subtitle('Signal = blue line A(t) = red line');
xlabel('Time', 'FontSize',14);% X-axis Label
ylabel('Amplitude', 'FontSize',14);% Y-axis Label
drawnow; %ensure drawings are complete
hold on;
plot(A_t5, '-r', 'LineWidth', 2);
hold off;

%% f) Plot about 100–200 samples from the middle of the signal and explain what you see, especially the frequency variation.

figure();
plot(y5(100:1:300));
title('Case 5 200 samples');

% This view of 200 samples doesn't show as much of a pattern. The principle 
% of frequency modulation can still be seen however, with the signal
% changing amplitude with varying frequencies in the 200 sample window.

%% Case 6 - fc=250 Hz; fm=350 Hz; I0=3; tau=1sec; dur=5sec; fs=11025;
%% a) Listen to sound by playing it with the soundsc function
%run bell function and create array of values

% ff = frequency vector (containing fc and fm)
ff6 = [250,350];
% Io = scale factor for modulation index
Io6 = 3;
% tau = decay parameter for A(t) and I(t)
tau6 = 1;
% dur = duration (in sec.) of the output signal
dur6 = 5;
% fsamp = sampling rate
fsamp6 = 11025;

y6 = bell(ff6,Io6,tau6,dur6,fsamp6);

%play the sound (array and sampling rate)
soundsc(y6, fsamp6);

%% b) Calculate the fundamental frequency of the "note" being played. 

% The fundamental frequency is calculated by finding the fourier transform
% or FFT of the bell sound and finding the frequency value with the first
% promiment peak. Any peaks that occur above this frequency are simply 
% harmonics. 
% (https://www.mathworks.com/help/matlab/math/fourier-transforms.html)
m6 = length(y6);
n6 = pow2(nextpow2(m6));
y6fft = fft(y6, n6);
f6 = (0:n6)*fsamp6/n6;
power6 = abs(y6fft).^2/n6;

%figure();
%plot(f6(1:floor(n6/2)),power6(1:floor(n6/2)));

peaks6 = islocalmax(power6, 'MinProminence', .5);
f06 = 0;
for i = 1:length(peaks6)
    if(peaks6(i) == 1)
        f06 = i*fsamp6/n6;
        break;
    else
        continue;
    end
end

%%Explain how you can verify by listening that you have the correct fundamental frequency.
% Just by listening, we can verify that we have the correct fundamental
% frequency by varying the carrier and modulating function parameters to get higher
% and lower toned sounds and see if our fundamental frequency calcuation is
% also going up and down with the tone changes. We can also compare the sound of our created
% note with the sound of the calculated natural freqeuncy using an online tone generator.

%% c) Describe how you can hear the frequency content changing according to I(t)
% The frequency content is most modified by changing the Io value. Changing
% tau affects how quickly the sound decays within the duration and the
% duration obviously affects how long the sound plays in general. The
% interesting change is with Io where the lower the modulation index is the
% 'purer' the tone sounds. There are fewer reverberations and
% overtones/harmonics. The more we raise the Io value the more overtones
% and harmonics we hear. 

%%Plot fi(t) versus t for comparison
% fi(t) = fc - I(t)*fm*sin(2pi*fm*t+phi_m) + dI/dt*cos(2*pi*fm*t+phi_m)
% (dI/dt = -1/tau * I0 * exp(-t/tau)

%defining terms
Psi_m6 = -pi/2;
Psi_c6 = -pi/2;
t6 =  0:1/fsamp6:dur6;

I_t6 = Io6 * bellenv(tau6, dur6, fsamp6); %call bell envelope function (exponential decay)

%calcualting fi_t
fi_t6 = ff6(1,1) - I_t6.*ff6(1,2).*cos(2*pi*ff6(1,1)*t6+Io6*I_t6*-1/tau6.*cos(2*pi*ff6(1,2)*t6+Psi_m6)+Psi_c6);

%All 6 cases will have their fi(t) plots plotted together on the same plot
%(fig 2) for comparison sake

%plotting normalized I(t) and fi(t)
figure(2);
subplot(3,2,6)
plot(t6, fi_t6/max(fi_t6), '-b');
hold on;
plot(t6, I_t6/max(I_t6), '-r');
hold off;
title('Case 6 fi(t) vs. t');

%% d) Display a spectrogram of the signal

figure();
plotspec(y6, fsamp6, 256);
title('Case 6 Spectrogram');

%%Describe how the frequency content changes, and how that change is related to I(t)
% The frequency content changes with I(t) by showing how long the harmonics
% and overtones last. We can see that the faster the decay rate or the
% larger tau is the sooner the frequency spectrum begins to have a
% diminshed influence from higher frequency aspects of the signal. Io also
% affects the plot by adding in higher frequency spectral lines. The
% higher the Io value the more harmonics or spectral lines we see on the
% graph.

%%Point out the "harmonic" structure of the spectrogram, and calculate the fundamental frequency, f0
% The fundamental frequency has been calculated at this point and the
% spectrogram shows that the fundamental frequency value is the one that
% has the strongest presence in the spectrogram at the end of the duration
% of the signal. The harmonic structure is seen with the spectral lines that 
% show how at the beginning of the noise a large number of frequencies
% contribute to the sound but by the end of the sound we are left with the
% fundamental frequency and maybe the first or second harmonic. 

%Case 6 fundamental frequency calculation result
f06

%% e) Plot the entire signal and compare it to the envelope A(t) generated by bellenv

%recalculating A(t)
A_t6 = bellenv(tau6, dur6, fsamp6);

%plot the signal
figure();
plot(y6);
set(gca,'FontSize',14); %set font size
title('Case 6 Signal and A(t)','FontSize',14); %Title
subtitle('Signal = blue line A(t) = red line');
xlabel('Time', 'FontSize',14);% X-axis Label
ylabel('Amplitude', 'FontSize',14);% Y-axis Label
drawnow; %ensure drawings are complete
hold on;
plot(A_t6, '-r', 'LineWidth', 2);
hold off;

%% f) Plot about 100–200 samples from the middle of the signal and explain what you see, especially the frequency variation.

figure();
plot(y6(100:1:300));
title('Case 6 200 samples');

% This view of 200 samples doesn't show as much of a pattern. The principle 
% of frequency modulation can still be seen however, with the signal
% changing amplitude with varying frequencies in the 200 sample window.

%% 4.4 Modifying the Fundamental Frequency

%% Test 1: Fc = 50 and Fm = 100 => F0 ~ 50
% ff = frequency vector (containing fc and fm)
ff1 = [50,100];
% Io = scale factor for modulation index
Io1 = 10;
% tau = decay parameter for A(t) and I(t)
tau1 = 2;
% dur = duration (in sec.) of the output signal
dur1 = 6;
% fsamp = sampling rate
fsamp1 = 11025;


y1 = bell(ff1,Io1,tau1,dur1,fsamp1);

%play the sound (array and sampling rate)
soundsc(y1, fsamp1);

%%Describe what you hear:
% In this test the pitch was very low and the sound seemed to decay or end
% realtively quick. 

%% Test 2: fc = 200 fm = 400 => F0 ~ 200
% ff = frequency vector (containing fc and fm)
ff2 = [200,400];
% Io = scale factor for modulation index
Io2 = 10;
% tau = decay parameter for A(t) and I(t)
tau2 = 2;
% dur = duration (in sec.) of the output signal
dur2 = 6;
% fsamp = sampling rate
fsamp2 = 11025;


y2 = bell(ff2,Io2,tau2,dur2,fsamp2);

%play the sound (array and sampling rate)
soundsc(y2, fsamp2);

%%Describe what you hear:
% In this test the pitch was was at a comfortable level and the sound seemed 
% to decay relatively slow.

%% Test 3: fc = 400 fm = 800 => F0 ~ 400
% ff = frequency vector (containing fc and fm)
ff3 = [400,800];
% Io = scale factor for modulation index
Io3 = 10;
% tau = decay parameter for A(t) and I(t)
tau3 = 2;
% dur = duration (in sec.) of the output signal
dur3 = 6;
% fsamp = sampling rate
fsamp3 = 11025;


y3 = bell(ff3,Io3,tau3,dur3,fsamp3);

%play the sound (array and sampling rate)
soundsc(y3, fsamp3);

%% Test 4: fc = 800 fm = 1600 => F0 ~ 800
% ff = frequency vector (containing fc and fm)
ff4 = [800,1600];
% Io = scale factor for modulation index
Io4 = 10;
% tau = decay parameter for A(t) and I(t)
tau4 = 2;
% dur = duration (in sec.) of the output signal
dur4 = 6;
% fsamp = sampling rate
fsamp4 = 11025;


y4 = bell(ff4,Io4,tau4,dur4,fsamp4);

%play the sound (array and sampling rate)
soundsc(y4, fsamp4);

%%Describe what you hear:
% In this test the pitch was was at a very high level and the overtones
% were not very pleasant to listen to. The harmonics or overtones decayed 
% quickly but the fundamental frequency seemed to decay at a slower rate.

%% Frequency Modulation Ratio Tests

%% Test 1: 5:7 Ratio (f0 = 40)
% ff = frequency vector (containing fc and fm)
ff5 = [200, 280];
% Io = scale factor for modulation index
Io5 = 10;
% tau = decay parameter for A(t) and I(t)
tau5 = 2;
% dur = duration (in sec.) of the output signal
dur5 = 6;
% fsamp = sampling rate
fsamp5 = 11025;


y5 = bell(ff5,Io5,tau5,dur5,fsamp5);

%play the sound (array and sampling rate)
soundsc(y5, fsamp5);

%% Test 2: 7:5 Ratio (f0 = 40)
% ff = frequency vector (containing fc and fm)
ff6 = [280,200];
% Io = scale factor for modulation index
Io6 = 10;
% tau = decay parameter for A(t) and I(t)
tau6 = 2;
% dur = duration (in sec.) of the output signal
dur6 = 6;
% fsamp = sampling rate
fsamp6 = 11025;


y6 = bell(ff6,Io6,tau6,dur6,fsamp6);

%play the sound (array and sampling rate)
soundsc(y6, fsamp6);

%% Test 3: 1:6
% ff = frequency vector (containing fc and fm)
ff7 = [110,610];
% Io = scale factor for modulation index
Io7 = 10;
% tau = decay parameter for A(t) and I(t)
tau7 = 2;
% dur = duration (in sec.) of the output signal
dur7 = 6;
% fsamp = sampling rate
fsamp7 = 11025;


y7 = bell(ff7,Io7,tau7,dur7,fsamp7);

%play the sound (array and sampling rate)
soundsc(y7, fsamp7);

%% Test 4: 7:11 Ratio
% ff = frequency vector (containing fc and fm)
ff8 = [700,1100];
% Io = scale factor for modulation index
Io8 = 10;
% tau = decay parameter for A(t) and I(t)
tau8 = 2;
% dur = duration (in sec.) of the output signal
dur8 = 6;
% fsamp = sampling rate
fsamp8 = 11025;


y8 = bell(ff8,Io8,tau8,dur8,fsamp8);

%play the sound (array and sampling rate)
soundsc(y8, fsamp8);

%% Which parameters sound best?

% I think that the 5:7 or 1:2 ratios sound the best. With ratios that have
% the carrier frequency greater than the modulating frequency the sound
% seems clunky and like it interferes with itself. The 7:11 ratio had so
% many tones in it that it was hard to listen to. 
##### SOURCE END #####
--></body></html>